---
title: 2017-1-20-Service被意外杀死会自动重启么
tags: Android
grammar_cjkRuby: true
---

Android 7.0源码中的/frameworks/base/core/java/android/app/Service.java

``` java
   public @StartResult int onStartCommand(Intent intent, @StartArgFlags int flags, int startId) {
         onStart(intent, startId);
	     return mStartCompatibility ? START_STICKY_COMPATIBILITY : START_STICKY;
  }

```
从上述代码中,我们可以看到,默认的就是START_STICKY. 也就是在意外被杀死的情况下,会自动重启.

不信我们来做个实验,看以下代码, 是我写的Service,在应用启动后我会ps并kill掉我们的进程,可以预料的是我们的onStartCommand再次会被打印出来.

``` java 
/**
 * Created by xiamin on 1/17/17.
 */
public class MyService extends Service {
    @Override
    public IBinder onBind(Intent intent) {
        return myAidlInterface;
    }

    @Override
    public void onCreate() {
        Log.d("xiamin","onCreate");
        super.onCreate();
    }

    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        Log.d("xiamin","onStartCommand");
        return super.onStartCommand(intent,flags,startId);
    }
	
	@Override
    public void onDestroy() {
        super.onDestroy();
    }
}

调用方: startService(new Intent(this, MyService.class));

```
